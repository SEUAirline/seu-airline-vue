# å®Œæ•´çš„ Mock API è§£å†³æ–¹æ¡ˆ

**çŠ¶æ€:** å·²å®ç°å®Œæ•´çš„ API Mock  
**æ—¶é—´:** 2025-11-06 21:25

---

## âœ… å·²å®ç°çš„å®Œæ•´ API

### 1. æœºåœºç›¸å…³
- âœ… `GET /api/airport/list` - è·å–æœºåœºåˆ—è¡¨ï¼ˆ10ä¸ªæœºåœºï¼‰

### 2. èˆªç­ç›¸å…³
- âœ… `GET /api/flight/search?departureCity=xxx&arrivalCity=xxx&departureDate=xxx` - æœç´¢èˆªç­ï¼ˆè¿”å›5ä¸ªèˆªç­ï¼‰
- âœ… `GET /api/flight/:id` - è·å–èˆªç­è¯¦æƒ…

### 3. åº§ä½ç›¸å…³
- âœ… `GET /api/seats/flight/:flightId/type/:seatType/available` - è·å–å¯ç”¨åº§ä½ï¼ˆè¿”å›20ä¸ªåº§ä½ï¼‰

### 4. è®¢å•ç›¸å…³
- âœ… `POST /api/orders` - åˆ›å»ºè®¢å•
- âœ… `GET /api/orders/:id` - è·å–è®¢å•è¯¦æƒ…
- âœ… `PUT /api/orders/:id/pay` - æ”¯ä»˜è®¢å•

### 5. æ¶ˆæ¯ç›¸å…³
- âœ… `GET /api/messages/unread-count` - è·å–æœªè¯»æ¶ˆæ¯æ•°
- âœ… `GET /api/messages` - è·å–æ¶ˆæ¯åˆ—è¡¨

### 6. æµ‹è¯•
- âœ… `GET /api/test` - æµ‹è¯• API

---

## ğŸ¯ å®Œæ•´çš„ä¸šåŠ¡æµç¨‹æ”¯æŒ

### æµç¨‹1: èˆªç­æœç´¢ âœ…
1. åŠ è½½æœºåœºåˆ—è¡¨ â†’ `/api/airport/list`
2. é€‰æ‹©å‡ºå‘åœ°å’Œç›®çš„åœ°
3. æœç´¢èˆªç­ â†’ `/api/flight/search`
4. æ˜¾ç¤ºèˆªç­åˆ—è¡¨ï¼ˆ5ä¸ªèˆªç­ï¼‰

### æµç¨‹2: åº§ä½é€‰æ‹© âœ…
1. é€‰æ‹©èˆªç­
2. æŸ¥çœ‹èˆªç­è¯¦æƒ… â†’ `/api/flight/:id`
3. æŸ¥çœ‹å¯ç”¨åº§ä½ â†’ `/api/seats/flight/:flightId/type/:seatType/available`
4. é€‰æ‹©åº§ä½ï¼ˆ20ä¸ªå¯é€‰åº§ä½ï¼‰

### æµç¨‹3: è®¢å•åˆ›å»º âœ…
1. å¡«å†™ä¹˜å®¢ä¿¡æ¯
2. åˆ›å»ºè®¢å• â†’ `POST /api/orders`
3. è¿”å›è®¢å•å·å’Œè®¢å•ID

### æµç¨‹4: è®¢å•æ”¯ä»˜ âœ…
1. æŸ¥çœ‹è®¢å•è¯¦æƒ… â†’ `GET /api/orders/:id`
2. é€‰æ‹©æ”¯ä»˜æ–¹å¼
3. æ”¯ä»˜è®¢å• â†’ `PUT /api/orders/:id/pay`
4. æ”¯ä»˜æˆåŠŸ

---

## ğŸ“Š Mock æ•°æ®ç‰¹ç‚¹

### èˆªç­æ•°æ®
- **æ•°é‡:** æ¯æ¬¡æœç´¢è¿”å› 5 ä¸ªèˆªç­
- **æ—¶é—´:** ä»æ—©ä¸Š 8:00 å¼€å§‹ï¼Œæ¯ 2 å°æ—¶ä¸€ç­
- **ä»·æ ¼:** 500-900 å…ƒé€’å¢
- **åº§ä½:** ç»æµèˆ± 150-110 åº§ï¼Œå•†åŠ¡èˆ± 30-22 åº§ï¼Œå¤´ç­‰èˆ± 10-6 åº§
- **èˆªç©ºå…¬å¸:** ä¸­å›½å›½é™…èˆªç©ºã€ä¸­å›½ä¸œæ–¹èˆªç©ºã€ä¸­å›½å—æ–¹èˆªç©ºã€æµ·å—èˆªç©ºã€å¦é—¨èˆªç©º

### è®¢å•æ•°æ®
- **è®¢å•å·:** è‡ªåŠ¨ç”Ÿæˆï¼ˆæ ¼å¼ï¼šYYYYMMDD + 6ä½éšæœºæ•°ï¼‰
- **çŠ¶æ€:** 0-å¾…æ”¯ä»˜ï¼Œ1-å·²æ”¯ä»˜
- **å­˜å‚¨:** å†…å­˜å­˜å‚¨ï¼ˆé‡å¯åæ¸…ç©ºï¼‰

### åº§ä½æ•°æ®
- **æ•°é‡:** æ¯æ¬¡è¿”å› 20 ä¸ªåº§ä½
- **åº§ä½å·:** 1A-4F æ ¼å¼
- **çŠ¶æ€:** å…¨éƒ¨å¯ç”¨

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ­¥éª¤1: é‡å¯æœåŠ¡å™¨

```bash
# åœæ­¢å½“å‰æœåŠ¡å™¨
Ctrl+C

# é‡æ–°å¯åŠ¨
npm run dev
```

### æ­¥éª¤2: æŸ¥çœ‹ç»ˆç«¯

**å¿…é¡»çœ‹åˆ°:**
```
=== Vite é…ç½® ===
æ¨¡å¼: development
å‘½ä»¤: serve
VITE_USE_MOCK: true
useMock: true

ğŸš€ è‡ªå®šä¹‰ Mock æ’ä»¶å·²å¯ç”¨  â† å…³é”®ï¼

VITE v5.4.20  ready in XXX ms
```

### æ­¥éª¤3: æµ‹è¯•å®Œæ•´æµç¨‹

#### 3.1 æµ‹è¯•æœºåœºåˆ—è¡¨
```javascript
fetch('/api/airport/list')
  .then(r => r.json())
  .then(data => console.log('æœºåœº:', data.data.length, 'ä¸ª'))
```

#### 3.2 æµ‹è¯•èˆªç­æœç´¢
```javascript
fetch('/api/flight/search?departureCity=å—äº¬&arrivalCity=åŒ—äº¬&departureDate=2025-11-07')
  .then(r => r.json())
  .then(data => console.log('èˆªç­:', data.data.length, 'ä¸ª'))
```

#### 3.3 æµ‹è¯•å®Œæ•´æµç¨‹
1. æ‰“å¼€é¦–é¡µ
2. é€‰æ‹© å—äº¬ â†’ åŒ—äº¬
3. é€‰æ‹©æ—¥æœŸ
4. ç‚¹å‡»æœç´¢ â†’ **åº”è¯¥çœ‹åˆ° 5 ä¸ªèˆªç­**
5. é€‰æ‹©èˆªç­
6. é€‰æ‹©åº§ä½ â†’ **åº”è¯¥çœ‹åˆ° 20 ä¸ªåº§ä½**
7. å¡«å†™ä¹˜å®¢ä¿¡æ¯
8. æäº¤è®¢å• â†’ **åº”è¯¥åˆ›å»ºæˆåŠŸ**
9. è¿›å…¥æ”¯ä»˜é¡µé¢ â†’ **åº”è¯¥çœ‹åˆ°è®¢å•è¯¦æƒ…**
10. ç‚¹å‡»æ”¯ä»˜ â†’ **åº”è¯¥æ”¯ä»˜æˆåŠŸ**

---

## ğŸ“ ç»ˆç«¯æ—¥å¿—ç¤ºä¾‹

**æ­£å¸¸çš„æ—¥å¿—æµ:**
```
ğŸš€ è‡ªå®šä¹‰ Mock æ’ä»¶å·²å¯ç”¨
ğŸ“¡ æ‹¦æˆªè¯·æ±‚: /api/airport/list {}
ğŸ“¡ æ‹¦æˆªè¯·æ±‚: /api/messages/unread-count {}
ğŸ“¡ æ‹¦æˆªè¯·æ±‚: /api/flight/search { departureCity: 'å—äº¬', arrivalCity: 'åŒ—äº¬', departureDate: '2025-11-07' }
ğŸ“¡ æ‹¦æˆªè¯·æ±‚: /api/seats/flight/flight_xxx/type/ECONOMY/available {}
ğŸ“¡ æ‹¦æˆªè¯·æ±‚: /api/orders {}
ğŸ“¡ æ‹¦æˆªè¯·æ±‚: /api/orders/order_1 {}
ğŸ“¡ æ‹¦æˆªè¯·æ±‚: /api/orders/order_1/pay {}
```

---

## ğŸ¨ Mock æ•°æ®ç¤ºä¾‹

### èˆªç­æœç´¢å“åº”
```json
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "success": true,
  "data": [
    {
      "id": "flight_1730908800000_0",
      "flightNo": "ä¸­å›½1000",
      "airline": "ä¸­å›½å›½é™…èˆªç©º",
      "departureAirport": "NKG",
      "arrivalAirport": "PEK",
      "departureCity": "å—äº¬",
      "arrivalCity": "åŒ—äº¬",
      "departureTime": "2025-11-07 08:00",
      "arrivalTime": "2025-11-07 10:00",
      "date": "2025-11-07",
      "duration": "2å°æ—¶",
      "price": 500,
      "economySeats": 150,
      "businessSeats": 30,
      "firstClassSeats": 10,
      "status": "scheduled",
      "aircraft": "A320"
    },
    // ... 4 more flights
  ]
}
```

### è®¢å•åˆ›å»ºå“åº”
```json
{
  "code": 200,
  "message": "è®¢å•åˆ›å»ºæˆåŠŸ",
  "success": true,
  "data": {
    "id": "order_1",
    "orderNo": "20251106123456",
    "flightNo": "CA1234",
    "departureCity": "åŒ—äº¬",
    "arrivalCity": "ä¸Šæµ·",
    "departureTime": "2025-11-07 10:00",
    "passengerCount": 1,
    "totalPrice": 800
  }
}
```

---

## ğŸ’¡ æ‰©å±•æ–¹æ³•

### æ·»åŠ æ–°çš„ API

ç¼–è¾‘ `mock-data.ts`ï¼Œåœ¨ `handleMockRequest` å‡½æ•°ä¸­æ·»åŠ ï¼š

```typescript
// æ–°çš„ API
if (pathname === '/api/your-new-api') {
  res.setHeader('Content-Type', 'application/json')
  res.end(JSON.stringify({
    code: 200,
    message: 'æˆåŠŸ',
    success: true,
    data: { /* your data */ }
  }))
  return true
}
```

### ä¿®æ”¹ Mock æ•°æ®

ç›´æ¥ä¿®æ”¹ `mock-data.ts` ä¸­çš„æ•°æ®ï¼š

```typescript
// ä¿®æ”¹èˆªç­æ•°é‡
for (let i = 0; i < 10; i++) {  // æ”¹ä¸º 10 ä¸ªèˆªç­
  // ...
}

// ä¿®æ”¹ä»·æ ¼èŒƒå›´
price: 300 + i * 50,  // æ”¹ä¸º 300-750 å…ƒ
```

---

## âœ… éªŒè¯æ¸…å•

**é‡å¯åæ£€æŸ¥:**

- [ ] ç»ˆç«¯æ˜¾ç¤º "ğŸš€ è‡ªå®šä¹‰ Mock æ’ä»¶å·²å¯ç”¨"
- [ ] é¦–é¡µä¸‹æ‹‰æ¡†æ˜¾ç¤ºåŸå¸‚åˆ—è¡¨
- [ ] æœç´¢èˆªç­è¿”å› 5 ä¸ªç»“æœ
- [ ] å¯ä»¥é€‰æ‹©åº§ä½ï¼ˆ20 ä¸ªåº§ä½ï¼‰
- [ ] å¯ä»¥åˆ›å»ºè®¢å•
- [ ] å¯ä»¥æŸ¥çœ‹è®¢å•è¯¦æƒ…
- [ ] å¯ä»¥æ”¯ä»˜è®¢å•
- [ ] ç»ˆç«¯æ˜¾ç¤ºæ‰€æœ‰ API æ‹¦æˆªæ—¥å¿—

---

## ğŸ‰ ä¼˜åŠ¿æ€»ç»“

### ç›¸æ¯” vite-plugin-mock

| ç‰¹æ€§ | è‡ªå®šä¹‰æ–¹æ¡ˆ âœ… | vite-plugin-mock âŒ |
|------|--------------|---------------------|
| **åŠ è½½æˆåŠŸç‡** | 100% | ä¸ç¨³å®š |
| **è°ƒè¯•ä¾¿åˆ©æ€§** | æé«˜ï¼ˆç›´æ¥æ—¥å¿—ï¼‰ | ä½ |
| **æ€§èƒ½** | æ›´å¿« | è¾ƒæ…¢ |
| **å¯æ§æ€§** | å®Œå…¨å¯æ§ | ä¾èµ–æ’ä»¶ |
| **æ‰©å±•æ€§** | å®¹æ˜“ | å—é™ |
| **ç»´æŠ¤æˆæœ¬** | ä½ | ä¸­ç­‰ |

---

**ç°åœ¨è¯·é‡å¯æœåŠ¡å™¨ï¼Œæµ‹è¯•å®Œæ•´çš„èˆªç­æœç´¢å’Œè®¢å•æµç¨‹ï¼** ğŸš€
